<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-58WNFTH58D"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-58WNFTH58D');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn how to solve Word Search II using Trie. medium difficulty. Time: O(m * n * 4^L), Space: O(total chars in words).">
    <link rel="canonical" href="https://leeteye.com/problems/tries/word-search-ii.html">

    <!-- Open Graph -->
    <meta property="og:title" content="Word Search II Solution | Trie | LeetEye">
    <meta property="og:description" content="Learn how to solve Word Search II using Trie. medium difficulty. Time: O(m * n * 4^L), Space: O(total chars in words).">
    <meta property="og:image" content="https://leeteye.com/assets/og-image.png">
    <meta property="og:url" content="https://leeteye.com/problems/tries/word-search-ii.html">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="LeetEye">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Word Search II Solution | Trie | LeetEye">
    <meta name="twitter:description" content="Learn how to solve Word Search II using Trie. medium difficulty. Time: O(m * n * 4^L), Space: O(total chars in words).">
    <meta name="twitter:image" content="https://leeteye.com/assets/og-image.png">

    <title>Word Search II Solution | Tries | LeetEye</title>

    <link rel="icon" type="image/png" href="../../../assets/logo.png">
    <link rel="apple-touch-icon" href="../../../assets/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/pseo.css">

    <!-- Schema.org HowTo -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Solve Word Search II",
        "description": "Build trie from words. DFS on grid while walking trie simultaneously. Prune when path isn&#039;t a trie prefix. Store found words, remove from trie to avoid duplicates.",
        "totalTime": "PT5M",
        "tool": {
            "@type": "HowToTool",
            "name": "Python"
        },
        "step": [
            {
            "@type": "HowToStep",
            "name": "Step 1",
            "text": "Using a trie for the word list helps because:",
            "position": 1
        },
{
            "@type": "HowToStep",
            "name": "Step 2",
            "text": "We should stop exploring a grid path when:",
            "position": 2
        },
{
            "@type": "HowToStep",
            "name": "Step 3",
            "text": "When DFS reaches a complete word in trie:",
            "position": 3
        },
{
            "@type": "HowToStep",
            "name": "Step 4",
            "text": "To ensure the same cell isn't used twice in a word:",
            "position": 4
        },
{
            "@type": "HowToStep",
            "name": "Step 5",
            "text": "After finding a word, we can:",
            "position": 5
        }
        ],
        "author": {
            "@type": "Organization",
            "name": "LeetEye",
            "url": "https://leeteye.com"
        }
    }
    </script>

    <!-- Schema.org FAQPage -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is the time complexity of Word Search II?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "The optimal solution has O(m * n * 4^L) time complexity and O(total chars in words) space complexity."
                }
            },
            {
                "@type": "Question",
                "name": "What pattern does Word Search II use?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Word Search II uses the Trie pattern. Build a trie from words. DFS on the grid, but use trie to prune impossible paths early."
                }
            }
        ]
    }
    </script>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="back-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                LeetEye
            </a>
            <img src="../../../assets/logo.png" alt="LeetEye" class="logo-small">
        </div>
    </header>

    <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol>
            <li><a href="/">Home</a></li>
            <li><a href="/patterns/">Patterns</a></li>
            <li><a href="/patterns/tries/">Tries</a></li>
            <li aria-current="page">Word Search II</li>
        </ol>
    </nav>

    <main class="content">
        <article class="problem-article">
            <header class="problem-header">
                <div class="problem-meta">
                    <span class="difficulty difficulty-medium">Medium</span>
                    <a href="/patterns/tries/" class="pattern-badge">Trie</a>
                    <span class="time-estimate">~5 min</span>
                </div>
                <h1>Word Search II</h1>
                <p class="problem-tags">
                    <span class="tag">tries</span>
<span class="tag">word-search-ii</span>
                </p>
            </header>

            <section class="problem-statement">
                <h2>Problem</h2>
                <div class="statement-text">
                    Given an <code>m x n</code> board of characters and a list of strings <code>words</code>, return all words on the board.<br><br>Each word must be constructed from letters of sequentially adjacent cells, where adjacent cells are horizontally or vertically neighboring. The same letter cell may not be used more than once in a word.
                </div>

                <div class="examples">
                    <h3>Examples</h3>
                    
        <div class="example">
            <div class="example-label">Example 1</div>
            <div class="example-input"><strong>Input:</strong> board = [[&quot;o&quot;,&quot;a&quot;,&quot;a&quot;,&quot;n&quot;],[&quot;e&quot;,&quot;t&quot;,&quot;a&quot;,&quot;e&quot;],[&quot;i&quot;,&quot;h&quot;,&quot;k&quot;,&quot;r&quot;],[&quot;i&quot;,&quot;f&quot;,&quot;l&quot;,&quot;v&quot;]], words = [&quot;oath&quot;,&quot;pea&quot;,&quot;eat&quot;,&quot;rain&quot;]</div>
            <div class="example-output"><strong>Output:</strong> [&quot;eat&quot;,&quot;oath&quot;]</div>
            
        </div>
    

        <div class="example">
            <div class="example-label">Example 2</div>
            <div class="example-input"><strong>Input:</strong> board = [[&quot;a&quot;,&quot;b&quot;],[&quot;c&quot;,&quot;d&quot;]], words = [&quot;abcb&quot;]</div>
            <div class="example-output"><strong>Output:</strong> []</div>
            
        </div>
    
                </div>
            </section>

            <section class="key-insight">
                <div class="key-insight-title">Key Insight</div>
                <p>Build a trie from words. DFS on the grid, but use trie to prune impossible paths early.</p>
                <p class="one-liner"><em>Build trie from words. DFS on grid while walking trie simultaneously. Prune when path isn&#039;t a trie prefix. Store found words, remove from trie to avoid duplicates.</em></p>
            </section>

            <section class="approach">
                <h2>How to Approach This Problem</h2>

                <div class="trigger-words">
                    <strong>Pattern Recognition:</strong> When you see keywords like
                    <span class="triggers"><span class="trigger-tag">word search ii</span> <span class="trigger-tag">tries</span></span>,
                    think <strong>Trie</strong>.
                </div>

                <h3>Step-by-Step Reasoning</h3>
                <div class="reasoning-steps">
                    
        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">1</span>
                Using a trie for the word list helps because:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> We can check if current path is a valid prefix in O(1)
            </div>
            <div class="step-explanation">
                Trie lets us know instantly if a path could lead to any word, enabling early pruning.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">2</span>
                We should stop exploring a grid path when:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Current path is not a prefix of any word
            </div>
            <div class="step-explanation">
                If no word starts with this prefix, don't waste time continuing.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">3</span>
                When DFS reaches a complete word in trie:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Add to results and continue exploring
            </div>
            <div class="step-explanation">
                "oath" might be found, but "oaths" could also exist. Continue exploring after finding a word.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">4</span>
                To ensure the same cell isn't used twice in a word:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Mark it during DFS, unmark on backtrack
            </div>
            <div class="step-explanation">
                Temporarily mark during exploration, restore when backtracking. Standard DFS pattern.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">5</span>
                After finding a word, we can:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Remove it from trie to avoid duplicates
            </div>
            <div class="step-explanation">
                Prevents finding the same word again. Also allows pruning empty trie branches.
            </div>
        </div>
                </div>
            </section>

            <section class="solution">
                <h2>Solution</h2>
                <pre><code class="language-python">class TrieNode:
    <span class="code-keyword">def</span> __init__(self):
        self.children = {}
        self.word = <span class="code-keyword">None</span>

<span class="code-keyword">def</span> findWords(board: List[List[<span class="code-func">str</span>]], words: List[<span class="code-func">str</span>]) -&gt; List[<span class="code-func">str</span>]:
    <span class="code-comment"># Build trie</span>
    root = TrieNode()
    <span class="code-keyword">for</span> word <span class="code-keyword">in</span> words:
        node = root
        <span class="code-keyword">for</span> char <span class="code-keyword">in</span> word:
            <span class="code-keyword">if</span> char <span class="code-keyword">not</span> <span class="code-keyword">in</span> node.children:
                node.children[char] = TrieNode()
            node = node.children[char]
        node.word = word
    
    result = []
    rows, cols = <span class="code-func">len</span>(board), <span class="code-func">len</span>(board[<span class="code-number">0</span>])
    
    <span class="code-keyword">def</span> dfs(r, c, node):
        char = board[r][c]
        <span class="code-keyword">if</span> char <span class="code-keyword">not</span> <span class="code-keyword">in</span> node.children:
            <span class="code-keyword">return</span>
        
        next_node = node.children[char]
        
        <span class="code-comment"># Found a word</span>
        <span class="code-keyword">if</span> next_node.word:
            result.<span class="code-func">append</span>(next_node.word)
            next_node.word = <span class="code-keyword">None</span>  <span class="code-comment"># Avoid duplicates</span>
        
        <span class="code-comment"># Mark visited</span>
        board[r][c] = &<span class="code-comment">#039;#&#039;</span>
        
        <span class="code-comment"># Explore neighbors</span>
        <span class="code-keyword">for</span> dr, dc <span class="code-keyword">in</span> [(<span class="code-number">0</span>,<span class="code-number">1</span>), (<span class="code-number">0</span>,-<span class="code-number">1</span>), (<span class="code-number">1</span>,<span class="code-number">0</span>), (-<span class="code-number">1</span>,<span class="code-number">0</span>)]:
            nr, nc = r + dr, c + dc
            <span class="code-keyword">if</span> <span class="code-number">0</span> &lt;= nr &lt; rows <span class="code-keyword">and</span> <span class="code-number">0</span> &lt;= nc &lt; cols <span class="code-keyword">and</span> board[nr][nc] != &<span class="code-comment">#039;#&#039;:</span>
                dfs(nr, nc, next_node)
        
        <span class="code-comment"># Restore</span>
        board[r][c] = char
    
    <span class="code-keyword">for</span> r <span class="code-keyword">in</span> <span class="code-func">range</span>(rows):
        <span class="code-keyword">for</span> c <span class="code-keyword">in</span> <span class="code-func">range</span>(cols):
            dfs(r, c, root)
    
    <span class="code-keyword">return</span> result</code></pre>

                <div class="complexity">
                    <h3>Complexity Analysis</h3>
                    <table class="complexity-table">
                        <tr>
                            <th>Time</th>
                            <td><code>O(m * n * 4^L)</code></td>
                        </tr>
                        <tr>
                            <th>Space</th>
                            <td><code>O(total chars in words)</code></td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Primary CTA -->
            <section class="cta-box">
                <h2>Master This Pattern</h2>
                <p>Build intuition with interactive MCQs. Practice Trie problems in the LeetEye app.</p>
                <a href="https://apps.apple.com/us/app/leeteye/id6756695234?utm_source=website&utm_medium=problem&utm_campaign=word-search-ii" class="cta-button cta-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                    </svg>
                    Download LeetEye Free
                </a>
            </section>

            <!-- Related Resources -->
            <aside class="related-resources">
                <h3>Tries Resources</h3>
                <ul class="resource-links">
                    <li><a href="/cheatsheets/tries.html">Tries Cheat Sheet</a></li>
                    <li><a href="/patterns/tries/">Tries Pattern Guide</a></li>
                    
                </ul>
            </aside>

            <!-- Related Problems -->
            <aside class="related-problems">
                <h3>More Tries Problems</h3>
                <ul class="problem-list">
                    
        <li>
            <a href="/problems/tries/implement-trie.html">
                <span class="problem-card-title">Implement Trie (Prefix Tree)</span>
                <span class="difficulty difficulty-medium">medium</span>
            </a>
        </li>
    

        <li>
            <a href="/problems/tries/design-add-and-search-words.html">
                <span class="problem-card-title">Design Add and Search Words Data Structure</span>
                <span class="difficulty difficulty-medium">medium</span>
            </a>
        </li>
    
                </ul>
                <a href="/patterns/tries/" class="see-all-link">See all Tries problems &rarr;</a>
            </aside>
        </article>
    </main>

    <!-- Sticky Mobile CTA -->
    <div class="sticky-cta">
        <a href="https://apps.apple.com/us/app/leeteye/id6756695234?utm_source=website&utm_medium=sticky&utm_campaign=word-search-ii" class="cta-button">
            Practice in LeetEye
        </a>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 LeetEye. Pattern recognition for coding interviews.</p>
            <nav class="footer-nav">
                <a href="/patterns/">All Patterns</a>
                <a href="/problems/">All Problems</a>
                <a href="/cheatsheets/">Cheat Sheets</a>
            </nav>
        </div>
    </footer>
</body>
</html>
