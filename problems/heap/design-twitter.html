<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-58WNFTH58D"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-58WNFTH58D');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn how to solve Design Twitter using Heap / Priority Queue. hard difficulty. Time: O(k log k) for getNewsFeed, Space: O(users + tweets).">
    <link rel="canonical" href="https://leeteye.com/problems/heap/design-twitter.html">

    <!-- Open Graph -->
    <meta property="og:title" content="Design Twitter Solution | Heap / Priority Queue | LeetEye">
    <meta property="og:description" content="Learn how to solve Design Twitter using Heap / Priority Queue. hard difficulty. Time: O(k log k) for getNewsFeed, Space: O(users + tweets).">
    <meta property="og:image" content="https://leeteye.com/assets/og-image.png">
    <meta property="og:url" content="https://leeteye.com/problems/heap/design-twitter.html">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="LeetEye">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Design Twitter Solution | Heap / Priority Queue | LeetEye">
    <meta name="twitter:description" content="Learn how to solve Design Twitter using Heap / Priority Queue. hard difficulty. Time: O(k log k) for getNewsFeed, Space: O(users + tweets).">
    <meta name="twitter:image" content="https://leeteye.com/assets/og-image.png">

    <title>Design Twitter Solution | Heap / Priority Queue | LeetEye</title>

    <link rel="icon" type="image/png" href="../../../assets/logo.png">
    <link rel="apple-touch-icon" href="../../../assets/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/pseo.css">

    <!-- Schema.org HowTo -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Solve Design Twitter",
        "description": "Merge k sorted tweet lists using heap. Each user&#039;s tweets are time-ordered. Heap holds one &#039;pointer&#039; per user, extracting top 10.",
        "totalTime": "PT5M",
        "tool": {
            "@type": "HowToTool",
            "name": "Python"
        },
        "step": [
            {
            "@type": "HowToStep",
            "name": "Step 1",
            "text": "Each user's tweets should be stored as:",
            "position": 1
        },
{
            "@type": "HowToStep",
            "name": "Step 2",
            "text": "User's followees should be stored as:",
            "position": 2
        },
{
            "@type": "HowToStep",
            "name": "Step 3",
            "text": "To get 10 most recent from k users:",
            "position": 3
        },
{
            "@type": "HowToStep",
            "name": "Step 4",
            "text": "For merging k tweet lists to get most recent:",
            "position": 4
        },
{
            "@type": "HowToStep",
            "name": "Step 5",
            "text": "Getting 10 tweets from k followed users:",
            "position": 5
        }
        ],
        "author": {
            "@type": "Organization",
            "name": "LeetEye",
            "url": "https://leeteye.com"
        }
    }
    </script>

    <!-- Schema.org FAQPage -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is the time complexity of Design Twitter?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "The optimal solution has O(k log k) for getNewsFeed time complexity and O(users + tweets) space complexity."
                }
            },
            {
                "@type": "Question",
                "name": "What pattern does Design Twitter use?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Design Twitter uses the Heap / Priority Queue pattern. NewsFeed = merge k sorted lists (each user&#039;s tweets are time-ordered)."
                }
            }
        ]
    }
    </script>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="/" class="back-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                LeetEye
            </a>
            <img src="../../../assets/logo.png" alt="LeetEye" class="logo-small">
        </div>
    </header>

    <nav class="breadcrumb" aria-label="Breadcrumb">
        <ol>
            <li><a href="/">Home</a></li>
            <li><a href="/patterns/">Patterns</a></li>
            <li><a href="/patterns/heap/">Heap / Priority Queue</a></li>
            <li aria-current="page">Design Twitter</li>
        </ol>
    </nav>

    <main class="content">
        <article class="problem-article">
            <header class="problem-header">
                <div class="problem-meta">
                    <span class="difficulty difficulty-hard">Hard</span>
                    <a href="/patterns/heap/" class="pattern-badge">Heap / Priority Queue</a>
                    <span class="time-estimate">~5 min</span>
                </div>
                <h1>Design Twitter</h1>
                <p class="problem-tags">
                    <span class="tag">heap</span>
<span class="tag">design-twitter</span>
                </p>
            </header>

            <section class="problem-statement">
                <h2>Problem</h2>
                <div class="statement-text">
                    Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and see the 10 most recent tweets in the user's news feed.<br><br>Implement the <code>Twitter</code> class:<br>- <code>Twitter()</code> Initializes your twitter object.<br>- <code>void postTweet(int userId, int tweetId)</code> Composes a new tweet with ID <code>tweetId</code> by the user <code>userId</code>. Each call to this function will be made with a unique <code>tweetId</code>.<br>- <code>List<Integer> getNewsFeed(int userId)</code> Retrieves the 10 most recent tweet IDs in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user themselves. Tweets must be ordered from most recent to least recent.<br>- <code>void follow(int followerId, int followeeId)</code> The user with ID <code>followerId</code> started following the user with ID <code>followeeId</code>.<br>- <code>void unfollow(int followerId, int followeeId)</code> The user with ID <code>followerId</code> started unfollowing the user with ID <code>followeeId</code>.
                </div>

                <div class="examples">
                    <h3>Examples</h3>
                    
        <div class="example">
            <div class="example-label">Example 1</div>
            <div class="example-input"><strong>Input:</strong> [&quot;Twitter&quot;, &quot;postTweet&quot;, &quot;getNewsFeed&quot;, &quot;follow&quot;, &quot;getNewsFeed&quot;, &quot;unfollow&quot;, &quot;getNewsFeed&quot;]</div>
            <div class="example-output"><strong>Output:</strong> [null, null, [5], null, [6, 5], null, [5]]</div>
            
        </div>
    
                </div>
            </section>

            <section class="key-insight">
                <div class="key-insight-title">Key Insight</div>
                <p>NewsFeed = merge k sorted lists (each user&#039;s tweets are time-ordered).</p>
                <p class="one-liner"><em>Merge k sorted tweet lists using heap. Each user&#039;s tweets are time-ordered. Heap holds one &#039;pointer&#039; per user, extracting top 10.</em></p>
            </section>

            <section class="approach">
                <h2>How to Approach This Problem</h2>

                <div class="trigger-words">
                    <strong>Pattern Recognition:</strong> When you see keywords like
                    <span class="triggers"><span class="trigger-tag">design twitter</span> <span class="trigger-tag">heap</span></span>,
                    think <strong>Heap / Priority Queue</strong>.
                </div>

                <h3>Step-by-Step Reasoning</h3>
                <div class="reasoning-steps">
                    
        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">1</span>
                Each user's tweets should be stored as:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> List ordered by time
            </div>
            <div class="step-explanation">
                Need to retrieve by recency. Newest first (or append and iterate backwards).
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">2</span>
                User's followees should be stored as:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Set
            </div>
            <div class="step-explanation">
                Need O(1) add, remove, and lookup. Set provides all three.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">3</span>
                To get 10 most recent from k users:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Use heap to merge k sorted lists
            </div>
            <div class="step-explanation">
                Merge k sorted lists is the classic heap problem. O(k log k) for 10 items.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">4</span>
                For merging k tweet lists to get most recent:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> Max-heap
            </div>
            <div class="step-explanation">
                We want the most recent (largest timestamp). Max-heap by timestamp.
            </div>
        </div>

        <div class="reasoning-step">
            <div class="step-question">
                <span class="step-number">5</span>
                Getting 10 tweets from k followed users:
            </div>
            <div class="step-answer">
                <strong>Answer:</strong> O(k log k) for 10 items = O(k log k)
            </div>
            <div class="step-explanation">
                Initialize heap with k users' latest tweets: O(k). Extract 10: O(10 log k).
            </div>
        </div>
                </div>
            </section>

            <section class="solution">
                <h2>Solution</h2>
                <pre><code class="language-python"><span class="code-keyword">import</span> heapq
<span class="code-keyword">from</span> collections <span class="code-keyword">import</span> defaultdict

class Twitter:
    <span class="code-keyword">def</span> __init__(self):
        self.time = <span class="code-number">0</span>
        self.tweets = defaultdict(<span class="code-func">list</span>)  <span class="code-comment"># userId -&gt; [(time, tweetId)]</span>
        self.following = defaultdict(<span class="code-func">set</span>)  <span class="code-comment"># userId -&gt; set of followeeIds</span>
    
    <span class="code-keyword">def</span> postTweet(self, userId: <span class="code-func">int</span>, tweetId: <span class="code-func">int</span>) -&gt; <span class="code-keyword">None</span>:
        self.tweets[userId].<span class="code-func">append</span>((self.time, tweetId))
        self.time += <span class="code-number">1</span>
    
    <span class="code-keyword">def</span> getNewsFeed(self, userId: <span class="code-func">int</span>) -&gt; List[<span class="code-func">int</span>]:
        <span class="code-comment"># Get tweets from user and all followees</span>
        heap = []
        users = self.following[userId] | {userId}
        
        <span class="code-keyword">for</span> uid <span class="code-keyword">in</span> users:
            <span class="code-keyword">if</span> self.tweets[uid]:
                idx = <span class="code-func">len</span>(self.tweets[uid]) - <span class="code-number">1</span>
                time, tweetId = self.tweets[uid][idx]
                heap.<span class="code-func">append</span>((-time, tweetId, uid, idx))
        
        heapq.heapify(heap)
        result = []
        
        <span class="code-keyword">while</span> heap <span class="code-keyword">and</span> <span class="code-func">len</span>(result) &lt; <span class="code-number">10</span>:
            _, tweetId, uid, idx = heapq.heappop(heap)
            result.<span class="code-func">append</span>(tweetId)
            
            <span class="code-keyword">if</span> idx &gt; <span class="code-number">0</span>:
                time, tweetId = self.tweets[uid][idx - <span class="code-number">1</span>]
                heapq.heappush(heap, (-time, tweetId, uid, idx - <span class="code-number">1</span>))
        
        <span class="code-keyword">return</span> result
    
    <span class="code-keyword">def</span> follow(self, followerId: <span class="code-func">int</span>, followeeId: <span class="code-func">int</span>) -&gt; <span class="code-keyword">None</span>:
        self.following[followerId].<span class="code-func">add</span>(followeeId)
    
    <span class="code-keyword">def</span> unfollow(self, followerId: <span class="code-func">int</span>, followeeId: <span class="code-func">int</span>) -&gt; <span class="code-keyword">None</span>:
        self.following[followerId].discard(followeeId)</code></pre>

                <div class="complexity">
                    <h3>Complexity Analysis</h3>
                    <table class="complexity-table">
                        <tr>
                            <th>Time</th>
                            <td><code>O(k log k) for getNewsFeed</code></td>
                        </tr>
                        <tr>
                            <th>Space</th>
                            <td><code>O(users + tweets)</code></td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Primary CTA -->
            <section class="cta-box">
                <h2>Master This Pattern</h2>
                <p>Build intuition with interactive MCQs. Practice Heap / Priority Queue problems in the LeetEye app.</p>
                <a href="https://apps.apple.com/app/leeteye?utm_source=website&utm_medium=problem&utm_campaign=design-twitter" class="cta-button cta-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                    </svg>
                    Download LeetEye Free
                </a>
            </section>

            <!-- Related Problems -->
            <aside class="related-problems">
                <h3>More Heap / Priority Queue Problems</h3>
                <ul class="problem-list">
                    
        <li>
            <a href="/problems/heap/kth-largest-element-in-stream.html">
                <span class="problem-card-title">Kth Largest Element in a Stream</span>
                <span class="difficulty difficulty-hard">hard</span>
            </a>
        </li>
    

        <li>
            <a href="/problems/heap/last-stone-weight.html">
                <span class="problem-card-title">Last Stone Weight</span>
                <span class="difficulty difficulty-hard">hard</span>
            </a>
        </li>
    

        <li>
            <a href="/problems/heap/k-closest-points-to-origin.html">
                <span class="problem-card-title">K Closest Points to Origin</span>
                <span class="difficulty difficulty-hard">hard</span>
            </a>
        </li>
    

        <li>
            <a href="/problems/heap/kth-largest-element-in-array.html">
                <span class="problem-card-title">Kth Largest Element in an Array</span>
                <span class="difficulty difficulty-hard">hard</span>
            </a>
        </li>
    

        <li>
            <a href="/problems/heap/task-scheduler.html">
                <span class="problem-card-title">Task Scheduler</span>
                <span class="difficulty difficulty-hard">hard</span>
            </a>
        </li>
    
                </ul>
                <a href="/patterns/heap/" class="see-all-link">See all Heap / Priority Queue problems &rarr;</a>
            </aside>
        </article>
    </main>

    <!-- Sticky Mobile CTA -->
    <div class="sticky-cta">
        <a href="https://apps.apple.com/app/leeteye?utm_source=website&utm_medium=sticky&utm_campaign=design-twitter" class="cta-button">
            Practice in LeetEye
        </a>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2024 LeetEye. Pattern recognition for coding interviews.</p>
            <nav class="footer-nav">
                <a href="/patterns/">All Patterns</a>
                <a href="/problems/">All Problems</a>
                <a href="/cheatsheets/">Cheat Sheets</a>
            </nav>
        </div>
    </footer>
</body>
</html>
